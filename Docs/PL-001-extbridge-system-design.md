# PL-001 ExtBridge：Exticを活用した個人契約クラウドサービス管理システム設計書

## 1. システム概要

### 1.1 目的
社員が業務で利用する個人契約クラウドサービスを、ExtBridge（Exticを活用したシステム）を通じて一元的に管理することで、セキュリティ強化、業務効率向上、コスト最適化、運用負担軽減を実現する。

### 1.2 対象サービス
- 開発者向けツール：GitHub Copilot、JetBrains製品群
- デザイン・クリエイティブツール：Figma、Adobe Creative Cloud個別アプリ
- マーケティング・分析ツール：Mailchimp Premiumなど
- その他、社員が業務上必要とする個人契約クラウドサービス

### 1.3 システムの位置づけ
ExtBridgeは全社的なID管理・認証基盤として機能し、個人契約サービスと既存の社内システム間の橋渡し役を担う。Exticの機能を拡張（Ext）し、各サービスとの橋渡し（Bridge）を行うことで、企業としてのガバナンスを確保しつつ個別ニーズに対応する。

## 2. 現状の課題と導入効果

### 2.1 現状の課題
- **セキュリティリスク**：退職時のアクセス権限管理が不完全
- **アカウント管理の分散**：サービスごとに個別アカウント管理が必要
- **コスト把握の困難**：利用状況の可視化が不十分
- **サポート負担**：個別対応によるIT部門の負担増加
- **コンプライアンス懸念**：企業資産としての管理体制不足

### 2.2 期待される効果

#### 2.2.1 セキュリティ強化
- 退職時や部署異動時のアクセス権限一括制御
- 統一的な多要素認証の適用
- 認証ログの一元管理と監視
- 強固なパスワードポリシーの統一的な適用

#### 2.2.2 業務効率向上
- シングルサインオンによるアクセス簡素化
- 統合ポータルからの各サービスへのアクセス
- サービス発見の容易化
- アカウント管理の自動化

#### 2.2.3 コスト最適化
- ライセンス利用状況の可視化
- 未使用アカウントの特定
- 部門別利用状況の分析
- ライセンス移管の効率化

#### 2.2.4 管理負担の軽減
- 管理作業の一元化
- 自動化によるIT部門工数削減
- 一貫したオンボーディング・オフボーディング
- トラブルシューティングの効率化

## 3. システムアーキテクチャ

### 3.1 全体アーキテクチャ
![ExtBridgeシステム全体アーキテクチャ]()

ExtBridgeは、Exticを中核とするハイブリッド階層型の統合アーキテクチャを採用。サービスの機能対応状況に応じて3階層での統合を行う。

### 3.2 コンポーネント構成

#### 3.2.1 ExtBridge中核システム（IdP/IdM層）
- Extic管理コンソール：管理者向けインターフェース
- ExtBridge利用者向けポータル：エンドユーザー向けアクセスポイント
- SAML IdP機能：シングルサインオン認証提供
- プロビジョニング機能：ユーザー情報連携
- コマンド実行エージェント：カスタム連携用モジュール

#### 3.2.2 サービス階層

1. **完全統合サービス**（SAML SSO + SCIMプロビジョニング対応）
   - GitHub Enterprise
   - Figma Organization/Enterprise
   - Adobe Creative Cloud Enterprise

2. **部分統合サービス**（SAML SSOのみ対応）
   - JetBrains製品（Hub経由）
   - その他SAML対応サービス

3. **リンク連携サービス**（SSO非対応）
   - 独自連携が必要なサービス
   - ポータルリンクのみ提供するサービス

### 3.3 通信・連携方式

#### 3.3.1 認証連携
- SAML 2.0プロトコルを使用したフェデレーション
- OIDCプロトコル（対応サービスのみ）
- Form-Based認証（対応サービスのみ）

#### 3.3.2 プロビジョニング連携
- SCIM 2.0プロトコルによる自動プロビジョニング
- 専用APIによる連携（サービス固有）
- コマンド実行機能による独自連携

#### 3.3.3 ログ・監視連携
- Syslogプロトコルによるログ集約
- API連携によるステータス監視
- Webhook連携によるイベント通知

## 4. 機能要件

### 4.1 Extic基本機能設定

#### 4.1.1 ユーザー・グループ管理機能
- 社内ディレクトリとの同期
- ユーザーの基本属性管理
- グループ管理と階層化
- ロール管理とアクセス制御

#### 4.1.2 シングルサインオン（SSO）機能
- SAML 2.0 IdP機能の構成
- 証明書の生成と管理
- IdP/SP開始フローの設定
- セッション管理とタイムアウト設定

#### 4.1.3 プロビジョニング機能
- ユーザー情報の連携設定
- グループ情報の連携設定
- プロビジョニング処理の監視
- エラー通知と復旧処理

#### 4.1.4 多要素認証機能
- アプリ認証方式の設定
- メール認証方式の設定
- 多要素認証の適用ポリシー設定
- 例外処理の設定

#### 4.1.5 ポータル機能
- アプリケーション表示設定
- カスタムロゴ・表示名設定
- アクセス権限に基づく表示制御
- メンテナンス情報表示

### 4.2 サービス連携機能

#### 4.2.1 GitHub管理機能
- Organization連携設定
- チーム同期設定
- リポジトリアクセス制御連携
- トークン・SSH鍵認証連携

#### 4.2.2 JetBrains管理機能
- License Vault連携設定
- Hub経由のSAML連携設定
- エージェント配置と構成
- ライセンス割り当て管理

#### 4.2.3 Figma管理機能
- Organization連携設定
- シート管理連携
- SCIMプロビジョニング設定
- チーム同期設定

#### 4.2.4 Adobe管理機能
- Single Appライセンス管理
- Admin Console連携
- ライセンスタイプ管理
- ストレージ割り当て管理

#### 4.2.5 その他サービス連携機能
- 汎用SAML連携設定
- API連携設定
- ポータルリンク管理
- アクセス権限管理

### 4.3 管理・運用機能

#### 4.3.1 ライセンス管理機能
- ライセンス割り当て状況表示
- 使用率モニタリング
- 更新通知
- コスト分析レポート

#### 4.3.2 監査・ログ機能
- 認証ログの収集・保存
- アクセスログの収集・保存
- 管理操作ログの収集・保存
- レポート出力機能

#### 4.3.3 通知・アラート機能
- 異常検知通知
- 証明書期限通知
- エラー検知通知
- 定期レポート配信

## 5. 非機能要件

### 5.1 セキュリティ要件
- 通信の暗号化（TLS 1.2以上）
- データ保存時の暗号化
- 認証情報の保護
- 多要素認証の適用
- アクセス制御の徹底

### 5.2 性能要件
- 同時ログインユーザー数：最大500ユーザー
- レスポンス時間：3秒以内
- バッチ処理時間：30分以内
- データ保持期間：監査ログ5年間

### 5.3 可用性要件
- 稼働率：99.9%（計画停止を除く）
- 計画メンテナンス：月1回（休日深夜）
- バックアップ：日次
- 障害復旧時間：4時間以内

### 5.4 運用保守要件
- 監視体制：24時間365日
- 障害対応：営業時間内
- 定期保守：月次
- バージョンアップ：年2回

## 6. システム連携設計

### 6.1 認証フロー
```
[ユーザー] → [ExtBridgeポータル] → [SAML認証処理] → [クラウドサービス]
```

1. ユーザーがExtBridge利用者ポータルにログイン
2. ポータル上のアプリケーションアイコンをクリック
3. ExtBridgeが対象サービス用のSAML Assertionを生成
4. ブラウザがAssertion情報を対象サービスに転送
5. サービス側で認証確認後、アクセス許可

### 6.2 プロビジョニングフロー
```
[ExtBridge管理コンソール] → [SCIM/API連携] → [クラウドサービス]
```

1. 管理者がユーザー/グループ情報を更新
2. ExtBridgeプロビジョニング機能が変更を検知
3. SCIM/APIリクエストをクラウドサービスに送信
4. サービス側でユーザー情報を更新
5. 処理結果をExtBridgeに返信

### 6.3 ログ・監視フロー
```
[クラウドサービス] → [ログ/イベント転送] → [ExtBridge]
```

1. クラウドサービス上でイベント発生
2. APIまたはWebhookでExtBridgeに通知
3. ExtBridgeがイベント情報を処理・保存
4. 必要に応じてアラート発報
5. ダッシュボードへの表示更新

## 7. 実装計画

### 7.1 フェーズ1：基盤構築（1-2ヶ月）
- Extic環境の構築とベース設定
- 証明書の生成と管理体制の確立
- 基本認証設定とテスト
- 利用者ポータルの初期設定

### 7.2 フェーズ2：SSO連携実装（2-3ヶ月）
- GitHub Enterprise SSOの設定
- Figma Organization SSOの設定
- JetBrains Hub SSOの設定
- Adobe Enterprise SSOの設定
- テスト・検証と調整

### 7.3 フェーズ3：プロビジョニング実装（2-3ヶ月）
- GitHub SCIMプロビジョニング設定
- Figma SCIMプロビジョニング設定
- Adobe ユーザー連携設定
- 自動同期のテスト・検証
- エラー処理の実装

### 7.4 フェーズ4：追加機能実装（3-4ヶ月）
- コマンド実行エージェントの開発
- カスタム連携の実装
- ライセンス管理システムの実装
- レポート・分析機能の実装
- 全体統合テスト

### 7.5 フェーズ5：本番展開（2-3ヶ月）
- パイロットユーザーによる検証
- 段階的なユーザー移行
- トレーニング・周知
- 運用体制の確立
- 完全展開

## 8. 運用・保守計画

### 8.1 運用体制
- システム管理者：1名
- サービス管理者：2名
- ヘルプデスク担当：1名
- 監視担当：1名（兼任）

### 8.2 定常運用タスク
- ユーザー管理（追加・変更・削除）
- アクセス権限管理
- ライセンス割り当て管理
- ログ・監視確認
- トラブル対応

### 8.3 定期保守タスク
- 証明書更新（年1回）
- バージョンアップ対応（年2回）
- セキュリティパッチ適用（随時）
- 設定バックアップ（月次）
- 性能チューニング（四半期）

### 8.4 監視項目
- サービス稼働状況
- 認証処理状況
- プロビジョニング処理状況
- エラー発生状況
- リソース使用状況

## 9. リスク管理

### 9.1 想定リスクと対策

| リスク | 影響度 | 発生確率 | 対策 |
|---|---|---|---|
| 証明書期限切れ | 高 | 中 | 自動監視と期限通知の設定 |
| 連携エラー | 中 | 高 | エラー検知と自動リトライ機能 |
| サービス仕様変更 | 高 | 中 | 定期的な動作確認と情報収集 |
| データ不整合 | 中 | 中 | 定期的な整合性チェック |
| 不正アクセス | 高 | 低 | 多要素認証と異常検知 |

### 9.2 サービス移行リスク

| サービス | リスク | 対策 |
|---|---|---|
| GitHub | 既存連携の断絶 | 段階的移行と並行運用 |
| JetBrains | ライセンス切り替え | 事前検証と移行スケジュール最適化 |
| Figma | データ移行 | バックアップと検証環境での確認 |
| Adobe | ライセンスタイプ変更 | 個別移行計画の策定 |

## 10. 検証計画

### 10.1 検証環境
- Exticテスト環境
- 各サービステスト環境
- テストユーザーアカウント

### 10.2 検証項目
- SSO認証フロー
- プロビジョニング処理
- ユーザー・グループ管理
- 権限変更時の連携
- エラー処理
- パフォーマンス検証

### 10.3 受入基準
- 全検証項目のパス
- エラー率1%未満
- 処理時間SLA達成
- セキュリティ要件充足

## 付録

### A. 用語集
- **ExtBridge**: 本システムの名称。Exticを拡張(Ext)し、クラウドサービスとの橋渡し(Bridge)を行う
- **Extic**: 本システムのベースとなる認証管理システム
- **IdP**: Identity Provider、認証情報の提供者
- **SP**: Service Provider、サービス提供者
- **SAML**: Security Assertion Markup Language、認証情報交換の標準規格
- **SCIM**: System for Cross-domain Identity Management、ID管理の標準規格
- **SSO**: Single Sign-On、シングルサインオン

### B. 参考資料
- Extic全体像文書
- 各クラウドサービスのAPI/連携ドキュメント
- SAML/SCIM技術仕様