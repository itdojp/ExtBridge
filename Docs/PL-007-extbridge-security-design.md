# ExtBridge セキュリティ設計書

## 1. はじめに

### 1.1 目的
本ドキュメントは、ExtBridgeシステムのセキュリティ要件を定義し、セキュリティ対策の設計方針を定めることを目的とします。

### 1.2 対象範囲
- システム全体のセキュリティ対策
- 認証・認可の仕組み
- データ保護のための暗号化方式
- セキュリティ監視・ログ取得の仕組み
- インシデント対応手順

## 2. セキュリティ要件

### 2.1 全般的なセキュリティ要件
- 機密性の高い情報は全て暗号化して保管・送信すること
- 最小権限の原則に基づいたアクセス制御を実施すること
- 全てのアクセスログを記録・保管すること
- 定期的な脆弱性診断を実施すること
- セキュリティパッチを速やかに適用すること

### 2.2 コンプライアンス要件
- 個人情報保護法に準拠すること
- 金融庁のサイバーセキュリティ対策強化に係る監督指針に準拠すること
- ISO/IEC 27001の管理策を参考に対策を講じること

## 3. システムアーキテクチャとセキュリティ

### 3.1 システム構成図
```
[インターネット]
      |
[WAF + CloudFront]
      |
[ALB (HTTPS終端)]
      |
[Web Server (Public)]
      |
[Application Server (Private)]
      |
[Database (Private)]
```

### 3.2 セキュリティゾーン
| ゾーン名 | 説明 | 含まれるリソース |
|---------|------|----------------|
| DMZ | インターネットから直接アクセス可能な領域 | ALB, WAF |
| アプリケーション層 | ビジネスロジックを実行する領域 | Webサーバー, アプリケーションサーバー |
| データ層 | データを保持する領域 | データベース, キャッシュサーバー |
| 管理層 | システム管理用の領域 | 管理コンソール, 監視サーバー |

## 4. 認証・認可

### 4.1 認証方式
- **多要素認証 (MFA)**
  - パスワード + ワンタイムパスワード（OTP）
  - 生体認証（スマートフォンアプリ連携）
- **シングルサインオン (SSO)**
  - SAML 2.0 または OpenID Connect をサポート
  - 主要なIDプロバイダーと連携（Google Workspace, Microsoft 365等）

### 4.2 認可モデル
- **ロールベースアクセス制御 (RBAC)**
  - 管理者: システム全体の設定・管理
  - 開発者: アプリケーションのデプロイ・管理
  - オペレーター: システム監視・運用
  - 一般ユーザー: アプリケーション利用

### 4.3 セッション管理
- セッションタイムアウト: 30分の無操作で自動ログアウト
- セッショントークン: JWT（JSON Web Token）を使用
- セッション固定攻撃対策: ログイン時にセッションIDを再生成

## 5. データ保護

### 5.1 暗号化
| データ種別 | 暗号化方式 | 鍵管理 |
|-----------|------------|--------|
| 保存データ | AES-256 | KMS |
| 通信経路 | TLS 1.3 | 証明書管理サービス |
| パスワード | bcrypt (ソルト+ストレッチング) | アプリケーションレイヤー |

### 5.2 データマスク
- 個人情報は表示時にマスキングを適用
- ログに出力する際は必要な最小限の情報のみを記録

## 6. ネットワークセキュリティ

### 6.1 ファイアウォールルール
| 種別 | 送信元 | 送信先 | プロトコル/ポート | 目的 |
|------|--------|--------|------------------|------|
| インバウンド | 全IP | ALB | HTTP/HTTPS | ユーザーアクセス |
| アウトバウンド | アプリケーションサーバー | データベース | 3306 | データベース接続 |
| アウトバウンド | アプリケーションサーバー | 外部API | 443 | 外部サービス連携 |

### 6.2 WAFルール
- OWASP ModSecurity Core Rule Set (CRS) の適用
- カスタムルールによるAPI保護
- レートリミットの設定

## 7. ロギングと監視

### 7.1 ログ収集項目
- 認証ログ（成功/失敗）
- 管理者操作ログ
- セキュリティイベントログ
- アプリケーションエラーログ
- アクセスログ

### 7.2 監視項目
- 不正ログイン試行
- 大量のリクエスト（DDoS攻撃の兆候）
- 不審なファイルアップロード
- 設定ファイルの変更

## 8. インシデント対応

### 8.1 インシデント対応フロー
1. 検知: 監視システムによる異常検知
2. 初動対応: 影響範囲の特定と一次対応
3. 調査: 原因の特定と影響範囲の特定
4. 復旧: システムの復旧作業
5. 再発防止: 再発防止策の検討と実施

### 8.2 連絡体制
- 24時間365日のオンコール体制
- エスカレーションフロー
- 外部連携先（セキュリティベンダー等）の連絡先

## 9. セキュリティテスト

### 9.1 テスト項目
- 脆弱性診断（VAPT）
- ペネトレーションテスト
- ソースコードレビュー
- 設定監査

### 9.2 テスト頻度
- 年2回の定期的なテスト
- 大きな機能追加・変更時のテスト
- 重大な脆弱性が発見された場合の随時テスト

## 10. セキュリティ教育・啓発

### 10.1 教育プログラム
- 新入社員向けセキュリティ研修
- 年1回の全社員向けセキュリティトレーニング
- フィッシングメール訓練

### 10.2 セキュリティポリシー
- パスワードポリシー
- リモートワーク時のセキュリティガイドライン
- インシデント報告手順

## 11. コンプライアンスと規制

### 11.1 準拠する規制
- 個人情報保護法
- 金融庁の監督指針
- サイバーセキュリティ基本法
- ISO/IEC 27001

### 11.2 コンプライアンス認証
- ISMS認証の取得
- プライバシーマークの取得
- SOC 2 Type II 認証の取得

## 12. リスク管理

### 12.1 リスク評価
- 定期的なリスクアセスメントの実施
- 脅威モデリングの作成
- ビジネスインパクト分析

### 12.2 リスク対応方針
- リスクの受容
- リスクの軽減
- リスクの移転（保険等）
- リスクの回避

## 13. 付録

### 13.1 用語集
- IDS/IPS: 侵入検知・防止システム
- SIEM: セキュリティ情報・イベント管理
- DLP: データ損失防止
- EDR: エンドポイント検出・対応

### 13.2 参考資料
- NIST サイバーセキュリティフレームワーク
- OWASP Top 10
- CISベンチマーク

---
**文書管理番号**: PL-007  
**版数**: 1.0  
**最終更新日**: 2025-03-22  
**作成者**: セキュリティ設計チーム  
**承認者**: セキュリティ責任者
